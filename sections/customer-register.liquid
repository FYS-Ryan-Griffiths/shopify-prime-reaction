{% comment %}
  Customer Register Section
{% endcomment %}

<section class="customer-register section">
  <div class="container container--narrow">
    <div class="customer-register__wrapper">
      <header class="customer-register__header">
        <h1 class="customer-register__title h2">{{ 'customer.register.title' | t }}</h1>
        <p class="customer-register__subtitle">{{ 'customer.register.subtitle' | t }}</p>
      </header>
      
      {%- form 'create_customer', class: 'customer-register__form' -%}
        {%- if form.errors -%}
          <div class="form-message form-message--error">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="15" y1="9" x2="9" y2="15"/>
              <line x1="9" y1="9" x2="15" y2="15"/>
            </svg>
            <span>{{ form.errors | default_errors }}</span>
          </div>
        {%- endif -%}
        
        <div class="form-row form-row--two">
          <div class="form-field">
            <label for="FirstName" class="form-label">{{ 'customer.register.first_name' | t }}</label>
            <input 
              type="text" 
              id="FirstName"
              name="customer[first_name]"
              class="form-input"
              autocomplete="given-name"
              required
            >
          </div>
          
          <div class="form-field">
            <label for="LastName" class="form-label">{{ 'customer.register.last_name' | t }}</label>
            <input 
              type="text" 
              id="LastName"
              name="customer[last_name]"
              class="form-input"
              autocomplete="family-name"
              required
            >
          </div>
        </div>
        
        <div class="form-field">
          <label for="Email" class="form-label">{{ 'customer.register.email' | t }}</label>
          <input 
            type="email" 
            id="Email"
            name="customer[email]"
            class="form-input"
            autocomplete="email"
            autocapitalize="off"
            autocorrect="off"
            required
          >
        </div>
        
        <div class="form-field">
          <label for="Password" class="form-label">{{ 'customer.register.password' | t }}</label>
          <div class="form-input-wrapper">
            <input 
              type="password" 
              id="Password"
              name="customer[password]"
              class="form-input"
              autocomplete="new-password"
              minlength="5"
              required
            >
            <button type="button" class="form-password-toggle" data-toggle-password aria-label="{{ 'customer.register.show_password' | t }}">
              <svg class="icon-show" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
              <svg class="icon-hide" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            </button>
          </div>
          <p class="form-hint">{{ 'customer.register.password_hint' | t }}</p>
        </div>
        
        {%- if section.settings.show_newsletter_checkbox -%}
          <div class="form-field form-field--checkbox">
            <label class="form-checkbox-label">
              <input type="checkbox" name="customer[accepts_marketing]" class="form-checkbox">
              <span class="form-checkbox-custom"></span>
              <span>{{ 'customer.register.newsletter' | t }}</span>
            </label>
          </div>
        {%- endif -%}
        
        <div class="form-field form-field--actions">
          <button type="submit" class="button button--primary button--large button--full">
            {{ 'customer.register.submit' | t }}
          </button>
        </div>
      {%- endform -%}
      
      <div class="customer-register__footer">
        <p>{{ 'customer.register.has_account' | t }}</p>
        <a href="{{ routes.account_login_url }}" class="button button--secondary">
          {{ 'customer.register.login' | t }}
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Password visibility toggle
    const toggleBtns = document.querySelectorAll('[data-toggle-password]');
    toggleBtns.forEach(btn => {
      btn.addEventListener('click', function() {
        const input = this.previousElementSibling;
        const showIcon = this.querySelector('.icon-show');
        const hideIcon = this.querySelector('.icon-hide');
        
        if (input.type === 'password') {
          input.type = 'text';
          showIcon.style.display = 'none';
          hideIcon.style.display = 'block';
        } else {
          input.type = 'password';
          showIcon.style.display = 'block';
          hideIcon.style.display = 'none';
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "Customer Register",
  "tag": "section",
  "class": "customer-register-section",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_newsletter_checkbox",
      "label": "Show newsletter signup checkbox",
      "default": true
    }
  ]
}
{% endschema %}
